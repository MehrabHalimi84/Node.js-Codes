ÛŒÙ‡ Ø§Ø³Ú©ÛŒÙ…Ø§ÛŒ Ø®ÙˆØ¨ Ø¨Ø±Ø§ÛŒ ÛŒÙˆØ²Ø±

const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true,
    minlength: 2,
    maxlength: 50
  },

  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    match: /^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/, // regex Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ…ÛŒÙ„
    maxlength: 100
  },

  password: {
    type: String,
    required: true,
    minlength: 8,  // Ø­Ø¯Ø§Ù‚Ù„ Ø§Ù…Ù†ÛŒØª
    maxlength: 1024 // Ú†ÙˆÙ† Ø±Ù…Ø² Ù‡Ø´â€ŒØ´Ø¯Ù‡ Ø·ÙˆÙ„Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´Ù‡
  },

  phone: {
    type: String,
    match: /^(\+98|0)?9\d{9}$/,  // Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø§ÛŒØ±Ø§Ù†ÛŒ
    maxlength: 15
  },

  isVerified: {
    type: Boolean,
    default: false
  },

  role: {
    type: String,
    enum: ['user', 'admin'],
    default: 'user'
  },

  address: {
    type: String,
    maxlength: 500
  },

  createdAt: {
    type: Date,
    default: Date.now
  }
});

module.exports = mongoose.model('User', userSchema);


lodash ÛŒÙ‡ Ù¾Ú©ÛŒØ¬ Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø¯Ù‡ ØªØ± Ú©Ø±Ø¯Ù† Ú©Ø¯

Ù…ØªÙˆØ¯ Ù‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± 
lodash

npm i lodash

Ú©Ø§Ø± Ø¨Ø§ ObjectÙ‡Ø§:
Ù…ØªØ¯	ØªÙˆØ¶ÛŒØ­
_.pick(obj, keys)	ÙÙ‚Ø· Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø®Ø§ØµÛŒ Ø§Ø² ÛŒÚ© Ø¢Ø¨Ø¬Ú©Øª Ø±Ùˆ Ø¨Ø±Ù…ÛŒâ€ŒØ¯Ø§Ø±Ù‡
_.omit(obj, keys)	Ù‡Ù…Ù‡ Ú©Ù„ÛŒØ¯Ù‡Ø§ Ø¨Ù‡â€ŒØ¬Ø² Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒØ´Ø¯Ù‡
_.has(obj, key)	Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ø¢ÛŒØ§ Ø¢Ø¨Ø¬Ú©Øª Ø§ÙˆÙ† Ú©Ù„ÛŒØ¯ Ø±Ùˆ Ø¯Ø§Ø±Ù‡ ÛŒØ§ Ù†Ù‡
_.get(obj, 'a.b.c')	Ú¯Ø±ÙØªÙ† Ù…Ù‚Ø¯Ø§Ø± Ø§Ø² Ø¹Ù…Ù‚ Ø²ÛŒØ§Ø¯ Ø¢Ø¨Ø¬Ú©Øª Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§
_.set(obj, 'a.b.c', value)	Ø³Øª Ú©Ø±Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø± Ø¹Ù…Ù‚ Ø®Ø§ØµÛŒ Ø§Ø² Ø¢Ø¨Ø¬Ú©Øª

ğŸ“Œ Ú©Ø§Ø± Ø¨Ø§ ArrayÙ‡Ø§:
Ù…ØªØ¯	ØªÙˆØ¶ÛŒØ­
_.uniq(array)	Ø­Ø°Ù Ù…Ù‚Ø§Ø¯ÛŒØ± ØªÚ©Ø±Ø§Ø±ÛŒ
_.flatten(array)	ØªØ®Øª Ú©Ø±Ø¯Ù† Ø¢Ø±Ø§ÛŒÙ‡ ÛŒÚ©â€ŒØ³Ø·Ø­ÛŒ
_.chunk(array, size)	ØªÙ‚Ø³ÛŒÙ… Ø¢Ø±Ø§ÛŒÙ‡ Ø¨Ù‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©ØªØ±
_.difference(a, b)	Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¯Ø± a Ù‡Ø³ØªÙ†Ø¯ ÙˆÙ„ÛŒ Ø¯Ø± b Ù†ÛŒØ³ØªÙ†Ø¯
_.intersection(a, b)	Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¯Ø± Ù‡Ø± Ø¯Ùˆ Ø¢Ø±Ø§ÛŒÙ‡ Ù‡Ø³ØªÙ†Ø¯
_.orderBy(array, [key], [order])	Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ú†Ù†Ø¯ Ú©Ù„ÛŒØ¯ Ùˆ ØªØ±ØªÛŒØ¨ (Ù…Ø«Ù„ SQL)

ğŸ“Œ Ú©Ø§Ø± Ø¨Ø§ String:
Ù…ØªØ¯	ØªÙˆØ¶ÛŒØ­
_.capitalize(str)	Ø­Ø±Ù Ø§ÙˆÙ„ Ø±Ùˆ Ø¨Ø²Ø±Ú¯ Ù…ÛŒâ€ŒÚ©Ù†Ù‡
_.kebabCase(str)	ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ kebab-case
_.camelCase(str)	ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ camelCase
_.snakeCase(str)	ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ snake_case

ğŸ“Œ Utility (Ø¹Ù…ÙˆÙ…ÛŒ):
Ù…ØªØ¯	ØªÙˆØ¶ÛŒØ­
_.isEmpty(obj)	Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ø®Ø§Ù„ÛŒÙ‡ ÛŒØ§ Ù†Ù‡ (Ø¨Ø±Ø§ÛŒ object, array, string...)
_.cloneDeep(obj)	Ú©Ù¾ÛŒ Ø¹Ù…ÛŒÙ‚ Ø§Ø² Ø¢Ø¨Ø¬Ú©Øª ÛŒØ§ Ø¢Ø±Ø§ÛŒÙ‡
_.debounce(func, delay)	Ú©Ù†ØªØ±Ù„ ÙØ±Ú©Ø§Ù†Ø³ Ø§Ø¬Ø±Ø§ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø±Ø§ÛŒ Ø³Ø±Ú†)
_.merge(obj1, obj2)	ØªØ±Ú©ÛŒØ¨ Ø¯Ùˆ Ø¢Ø¨Ø¬Ú©Øª (Ø¹Ù…ÛŒÙ‚)



user = new User(_.pick(req.body, ['name', 'email', 'password'])); // gooooood
Ø§ÛŒÙ† Ø¨Ø±Ø§Ø¨Ø± Ø§ÛŒÙ†Ù‡

 let user = new User({
        name: req.body.name,
        email: req.body.email,
        password: req.body.password,
    });


    Hashing password

  Ù‡Ø´ Ú©Ø±Ø¯Ù† Ø±Ù…Ø² ÙˆØ±ÙˆØ¯
  Ø¨Ù‡ Ù‡Ú©Ø± Ø§Ø¬Ø§Ø²Ù‡ Ù†Ù…ÛŒØ¯Ù‡ Ù¾Ø³ÙˆÙˆØ±Ø¯ Ø§ØµÙ„ÛŒÙ‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ùˆ Ø¨ÙÙ‡Ù…Ù‡ Ùˆ Ø³Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù‡ Ø­ØªÛŒ Ø§Ú¯Ù‡ Ø¯ÛŒØªØ§ Ø¨ÛŒØ³ Ø±Ùˆ Ù‡Ú© Ú©Ù†Ù‡ 

  ÛŒÙ‡ Ø¬ÙˆØ±Ø§ÛŒ Ø§Ø²Ø±Ø´ØªÙ‡ Ø±Ù…Ø² Ú©Ø§Ø±Ø¨Ø± ÛŒÙ‡ Ø±Ø´ØªÙ‡ ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¯Ø±Ø³Øª Ù…ÛŒÚ©Ù†Ù‡ Ú©Ù‡ ØªÙˆÛŒ Ø¯ÛŒØªØ§ Ø¨ÛŒØ³ Ø®ÙˆØ¯Ù‡ Ø±Ù…Ø² Ø§ØµÙ„ÛŒ Ø³ÛŒÙˆ Ù†Ø´Ù‡ Ø§ÙˆÙ† Ø³ÛŒÙˆ Ø¨Ø´Ù‡

    npm i bcrypt


    const salt = await bcrypt.gensalt(10);
Ø¨Ù‡ Ø§ÛŒÙ† Ù…ÛŒÚ¯Ù† ØªÙˆÙ„ÛŒØ¯ salt
Ù†Ù…Ú© 

Ø§ÙˆÙ„ ÛŒÙ‡ Ø²Ù…Ø± ØªØµØ§Ø¯ÙÛŒ Ø¯Ø±Ø³Øª Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ Ø§ÙˆÙ† Ø¯Ù‡ Ú©Ù‡ ØªÙˆÛŒ Ù‚Ø³Ù…Øª Ø§Ø±Ú¯ÙˆÙ…Ù†Øª Ù‡Ø± Ú†ÛŒ Ø¨ÛŒØ´ØªØ± Ø¨Ø´Ù‡ Ø§Ù…Ù†ÛŒØªØ´ Ø¨ÛŒØ´ØªØ± Ù…ÛŒÙ‡ Ø§Ù…Ø§ Ú©Ù†Ø¯ ØªØ± Ø¨Ù‡ØªØ±ÛŒØ´ 10

Ø¨Ø¹Ø¯

user.password = await bcrypt.hash(user.password, salt);
Ø­Ø§Ù„Ø§ ÛŒÙˆØ²Ø± Ù¾Ø³ÛŒ Ú©Ù‡ Ú¯Ø±ÙØªÛŒÙ… Ø±Ùˆ Ù‡Ø´ Ù…ÛŒÚ©Ù†ÛŒÙ…



const validPassword = await bcrypt.compare(req.body.password, user.password);
 Ø§ÛŒÙ†Ù… Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†Ù‡ Ú©Ù‡ Ø²Ù…Ø§Ù†Ù‡ ÙˆØ±ÙˆØ±Ø¯ Ø±Ù…Ø² Ø§ÙˆÙ„ÛŒ Ø±Ùˆ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú©Ù†Ù‡ Ø¨Ø§ Ø±Ù…Ø²Ù‡ Ù‡Ø´ Ø´Ø¯Ù‡ Ú©Ù‡ Ø¨Ø¨ÛŒÙ†Ù‡ Ø¯Ø±Ø³ØªÙ‡ ÛŒØ§ Ù†Ù‡
 